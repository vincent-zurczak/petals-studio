<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>

<!--
 <copyright>
	 Copyright (c) 2009-2018, Linagora

	 All rights reserved. This program and the accompanying materials
 	 are made available under the terms of the Eclipse Public License v1.0
 	 which accompanies this distribution, and is available at
 	 http://www.eclipse.org/legal/epl-v10.html
 
 	 Contributors:
     	 	Linagora - initial API and implementation
 </copyright>
-->

<plugin>
   <extension-point id="com.linagora.petals.common.projectCategories" name="Petals Project Categories" schema="schema/com.linagora.petals.common.projectCategories.exsd"/>
   <extension-point id="com.linagora.petals.common.formeditor" name="Petals Project Categories" schema="schema/com.linagora.petals.common.formeditor.exsd"/>
   <extension-point id="com.linagora.petals.common.croquisExtension" name="Petals Croquis Extension" schema="schema/com.linagora.petals.common.croquisExtension.exsd"/>

     <extension point="org.eclipse.ui.startup">
      <startup class="com.linagora.petals.common.internal.metamodel.validation.Startup"/>
   </extension>
   
<!--
   Constraint
   -->
 <extension point="org.eclipse.emf.validation.constraintProviders">
    <category
		id="com.linagora.jbi.core.metamodel.constraints.category"
		mandatory="true"
		name="JBI EMF Model - Constraints Category"> 
	</category>		
    <constraintProvider cache="true">
         <package namespaceUri="http://java.sun.com/xml/ns/jbi"/>
         <constraints categories="com.linagora.jbi.core.metamodel.constraints.category">
            <constraint
                  lang="Java"
                  class="com.linagora.petals.common.internal.metamodel.validation.constraints.ConsumesConstraints"
                  severity="WARNING"
                  mode="Batch"
                  name="JBIConsumesValidation"
                  id="com.linagora.jbi.core.metamodel.constraints.Consumes"
                  statusCode="1">
               <description>Validate a &apos;consumes&apos; element.
               </description>
               <message>
                  {0}
               </message>
               <target class="Consumes"/>                                   
            </constraint>
            <constraint
                  class="com.linagora.petals.common.internal.metamodel.validation.constraints.ConsumerConstraints"
                  id="com.linagora.jbi.core.metamodel.constraints.Consumer"
                  lang="Java"
                  mode="Batch"
                  name="JBIConsumerValidation"
                  severity="WARNING"
                  statusCode="1">
               <description>
                  Validate a&apos;consumer&apos; element.
               </description>
               <message>
                  {0}
               </message>
               <target
                     class="Consumer">
               </target>
            </constraint>
         </constraints>
      </constraintProvider>
   </extension>
   
    <extension
         point="org.eclipse.emf.validation.constraintBindings">
      <clientContext
            default="true"
            id="com.linagora.jbi.core.metamodel.navigation.context">
         <selector class="com.linagora.petals.common.internal.metamodel.validation.Context"/>
      </clientContext>
      <binding
            context="com.linagora.jbi.core.metamodel.navigation.context"
            category="com.linagora.jbi.core.metamodel.constraints.category"/>
   </extension>
    <extension
          point="org.eclipse.ui.commands">
       <category
             description="A set of commands related to to Petals tools"
             id="com.linagora.jbi.core.petals-category"
             name="Petals">
       </category>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             defaultHandler="com.linagora.petals.common.internal.commands.AddNatureHandler"
             id="com.linagora.petals.common.addPetalsNature"
             name="Add Petals Nature">
          <commandParameter
                id="natureId"
                name="Nature ID"
                optional="false">
          </commandParameter>
       </command>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             defaultHandler="com.linagora.petals.common.internal.commands.ValidateJbiXmlHandler"
             description="Validate jbi.xml files"
             id="com.linagora.petals.common.validate-jbi"
             name="Validate">
       </command>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             description="A fast export for Petals projects"
             id="com.linagora.petals.common.fastexport"
             name="Petals Fast Export">
       </command>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             description="A command to refactor a Petals project"
             id="com.linagora.petals.common.refactorProject"
             name="Refactor a Petals project">
       </command>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             defaultHandler="com.linagora.petals.common.internal.commands.VisitWebLinkHandler"
             description="Visit a web site"
             id="com.linagora.petals.common.visitWebLink"
             name="Visit Web Link">
          <commandParameter
                id="url"
                name="URL"
                optional="false">
          </commandParameter>
       </command>
       <command
             categoryId="com.linagora.jbi.core.petals-category"
             defaultHandler="com.linagora.petals.common.internal.commands.SwitchJavaPackageLayoutHandler"
             description="Command to switch the Java packages layout"
             id="com.linagora.petals.common.switchJavaPackagesLayout"
             name="Switch Java Package Layout">
          <state
                class="org.eclipse.ui.handlers.RadioState:hierarchical"
                id="org.eclipse.ui.commands.radioState">
          </state>
          <commandParameter
                id="org.eclipse.ui.commands.radioStateParameter"
                name="Layout"
                optional="false">
          </commandParameter>
       </command>
       <command
             description="%configureBuildPath_Desc"
             id="com.linagora.petals.common.configureBuildPathCommand"
             name="%configureBuildPath_Name">
       </command>
    </extension>
    <extension
          id="com.linagora.petals.common.schema"
          name="Petals XML Schema"
          point="org.eclipse.wst.xml.core.catalogContributions">
       <catalogContribution
             id="default">
          <uri
                name="http://java.sun.com/xml/ns/jbi"
                uri="xsd/specialized-su/jbi.xsd">
          </uri>
          <uri
                name="http://maven.apache.org/POM/4.0.0"
                uri="xsd/maven/maven-v4.0.0.xsd">
          </uri>
       </catalogContribution>
    </extension>
    <extension
          point="org.eclipse.ui.newWizards">
          
       <!-- Disable the JBI descriptor wizard -->
       <!--
       <wizard
             category="com.linagora.petals.common.wizards"
             class="com.linagora.petals.common.internal.wizards.JbiXmlNewWizard"
             finalPerspective="com.linagora.petals.common.mainPerspective"
             hasPages="true"
             icon="icons/obj16/jbi_descriptor.png"
             id="com.linagora.petals.common.newJbiXmlWizard"
             name="%wizardName"
             preferredPerspectives="com.linagora.petals.common.mainPerspective"
             project="false">
          <description>
             Create a new JBI descriptor
          </description>
       </wizard>
       -->
       
       <category
             id="com.linagora.petals.common.wizards"
             name="Petals">
       </category>
       <category
             id="com.linagora.petals.common.wizards.utilities"
             name="Petals Utilities">
       </category>
       <category
             id="com.linagora.petals.common.wizards.attic"
             name="Petals Attic">
       </category>
       <wizard
             category="com.linagora.petals.common.wizards"
             class="com.linagora.petals.common.croquis.internal.wizards.CroquisNewWizard"
             finalPerspective="com.linagora.petals.common.mainPerspective"
             hasPages="true"
             icon="icons/obj16/croquis.png"
             id="com.linagora.petals.common.croquisWizard"
             name="Croquis"
             project="false">
          <description>
             Create a Petals croquis
          </description>
       </wizard>
       <wizard
             category="com.linagora.petals.common.wizards.utilities"
             class="com.linagora.petals.common.internal.wizards.DeploymentScriptNewWizard"
             hasPages="true"
             icon="icons/obj16/ant_buildfile.gif"
             id="com.linagora.petals.common.deploymentScriptWizard"
             name="Deployment Script (ANT)">
          <description>
             Create an ANT file to script Petals deployments.
          </description>
       </wizard>
    </extension>
    <extension
          point="org.eclipse.ui.importWizards">
       <category
             id="com.linagora.petals.common.importWizard"
             name="Petals">
       </category>
    </extension>
    <extension
          point="org.eclipse.ui.exportWizards">
       <category
             id="com.linagora.petals.common.exportWizard"
             name="Petals">
       </category>
    </extension>
    <extension
          point="org.eclipse.ui.editors">
       <editor
             class="org.eclipse.wst.sse.ui.StructuredTextEditor"
             default="false"
             filenames="jbi.xml"
             icon="icons/obj16/jbi_descriptor.png"
             id="com.linagora.petals.common.sourceeditor"
             name="Petals Source Editor">
          <contentTypeBinding
                contentTypeId="com.linagora.petals.common.jbiContentType">
          </contentTypeBinding>
       </editor>
       <editor
             class="com.linagora.petals.common.internal.formeditor.JbiFormEditor"
             default="true"
             filenames="jbi.xml"
             icon="icons/obj16/jbi_descriptor.png"
             id="com.linagora.petals.common.formeditor"
             name="Petals Form Editor">
          <contentTypeBinding
                contentTypeId="com.linagora.petals.common.jbiContentType">
          </contentTypeBinding>
       </editor>
    </extension>
    <extension
          point="org.eclipse.ui.preferencePages">
       <page
             class="com.linagora.petals.common.internal.preferences.PetalsPreferencePage"
             id="com.linagora.petals.common.preferences"
             name="Petals">
       </page>
    </extension>
    <extension
          point="org.eclipse.wst.sse.ui.editorConfiguration">
       <sourceViewerConfiguration
             class="com.linagora.petals.common.internal.editor.JbiXmlViewerConfiguration"
             target="com.linagora.petals.common.xmleditor">
       </sourceViewerConfiguration>
    </extension>
    <extension
          point="org.eclipse.ui.views">
       <view
             category="com.linagora.petals.common.views"
             class="com.linagora.petals.common.internal.projectscnf.PetalsProjectNavigator"
             icon="icons/obj16/pstudio_16x16.png"
             id="com.linagora.petals.common.projects"
             name="Petals Projects">
          <description>
             A view to manage Petals projects.
          </description>
       </view>
       <category
             id="com.linagora.petals.common.views"
             name="Petals">
       </category>
    </extension>
    <extension
          point="org.eclipse.ui.navigator.viewer">
       <viewerActionBinding
             viewerId="com.linagora.petals.common.projects">
          <includes>
             <actionExtension
                   pattern="com.linagora.petals.common.projectscnf.*">
             </actionExtension>
             <actionExtension
                   pattern="org.eclipse.ui.navigator.resources.*">
             </actionExtension>
          </includes>
       </viewerActionBinding>
       <viewerContentBinding
             viewerId="com.linagora.petals.common.projects">
          <includes>
             <contentExtension
                   pattern="com.linagora.petals.projects.*">
             </contentExtension>
             <contentExtension
                   pattern="org.eclipse.ui.navigator.resources.filters.*">
             </contentExtension>
             <contentExtension
                   pattern="org.eclipse.ui.navigator.resources.linkHelper">
             </contentExtension>
          </includes>
       </viewerContentBinding>
       <dragAssistant
             class="org.eclipse.ui.navigator.resources.ResourceDragAdapterAssistant"
             viewerId="com.linagora.petals.common.projects" />
    </extension>
    <extension
          point="org.eclipse.ui.navigator.navigatorContent">

       <actionProvider
             class="com.linagora.petals.common.internal.projectscnf.actions.CategoryActionProvider"
             id="com.linagora.petals.common.projectscnf.categoryActionProvider">
          <enablement>
             <instanceof
                   value="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectCategory">
             </instanceof>
          </enablement>
       </actionProvider>
       <actionProvider
             class="com.linagora.petals.common.internal.projectscnf.actions.ResourceActionProvider"
             id="com.linagora.petals.common.projectscnf.resourceActionProvider"
             overrides="org.eclipse.ui.navigator.resources.NewActions">
          <enablement>
             <and>
                <with
                      variable="activePartId">
                   <equals
                         value="com.linagora.petals.common.projects">
                   </equals>
                </with>
                <with
                      variable="selection">
                   <count
                         value="*">
                   </count>
                </with>
                <not>
                   <instanceof
                         value="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectCategory">
                   </instanceof>
                </not>
             </and>
          </enablement>
       </actionProvider>
      <commonWizard
            type="new"
            wizardId="org.eclipse.ui.wizards.new.folder">
         <enablement></enablement>
      </commonWizard>
      <commonWizard
            type="new"
            wizardId="org.eclipse.ui.wizards.new.file">
         <enablement></enablement>
      </commonWizard>
      <commonWizard
            type="new"
            wizardId="org.eclipse.wst.wsdl.ui">
         <enablement></enablement>
      </commonWizard>
       <commonWizard
		        menuGroupId="petals.projects.resource.new"
		        type="new"
		        wizardId="org.eclipse.jdt.ui.wizards.NewPackageCreationWizard">
		     <enablement>
		        <or>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragment"/>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragmentRoot"/>
		           <instanceof value="org.eclipse.jdt.core.ICompilationUnit"/>
		           <adapt type="org.eclipse.core.resources.IProject">
		             	<test property="org.eclipse.core.resources.projectNature" value="org.eclipse.jdt.core.javanature"/>
		           </adapt>
		        </or>
		     </enablement>
		  </commonWizard>
		  <commonWizard
		        menuGroupId="petals.projects.resource.new"
		        type="new"
		        wizardId="org.eclipse.jdt.ui.wizards.NewClassCreationWizard">
		     <enablement>
		        <or>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragment"/>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragmentRoot"/>
		           <instanceof value="org.eclipse.jdt.core.ICompilationUnit"/>
		           <adapt type="org.eclipse.core.resources.IProject">
		              <test property="org.eclipse.core.resources.projectNature" value="org.eclipse.jdt.core.javanature"/>
		           </adapt>
		        </or>
		     </enablement>
		  </commonWizard>
   	      <commonWizard
		        menuGroupId="petals.projects.resource.new"
		        type="new"
		        wizardId="org.eclipse.jdt.ui.wizards.NewInterfaceCreationWizard">
		     <enablement>
		        <or>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragment"/>
		           <instanceof value="org.eclipse.jdt.core.IPackageFragmentRoot"/>
		           <instanceof value="org.eclipse.jdt.core.ICompilationUnit"/>
		           <adapt type="org.eclipse.core.resources.IProject">
		              <test property="org.eclipse.core.resources.projectNature" value="org.eclipse.jdt.core.javanature"/>
		           </adapt>
		        </or>
		     </enablement>
		  	</commonWizard>
			<commonWizard
				  menuGroupId="petals.projects.resource.new"
		          type="new"
		          wizardId="org.eclipse.jdt.ui.wizards.NewEnumCreationWizard">
				<enablement>
					<or>
						<instanceof value="org.eclipse.jdt.core.IPackageFragment"/>
						<instanceof value="org.eclipse.jdt.core.IPackageFragmentRoot"/>
						<instanceof value="org.eclipse.jdt.core.ICompilationUnit"/>
						<adapt type="org.eclipse.core.resources.IProject">
							<test property="org.eclipse.core.resources.projectNature" value="org.eclipse.jdt.core.javanature"/>
						</adapt>
					</or>
				 </enablement>
		    </commonWizard>	 
		    <commonWizard
		          menuGroupId="petals.projects.resource.new"
		          type="new"
		          wizardId="org.eclipse.jdt.ui.wizards.NewSourceFolderCreationWizard">
				<enablement>
					<or> 
						<instanceof value="org.eclipse.jdt.core.IPackageFragmentRoot"/> 
						<adapt type="org.eclipse.core.resources.IProject">
							<test property="org.eclipse.core.resources.projectNature" value="org.eclipse.jdt.core.javanature"/>
					</adapt>
				</or>
			</enablement>
		</commonWizard>
      <commonWizard
            type="import"
            wizardId="com.linagora.petals.common.importWsdl">
         <enablement></enablement>
      </commonWizard>
      <commonFilter
            activeByDefault="true"
            class="com.linagora.petals.common.internal.projectscnf.EmptyJavaPackageFilter"
            id="com.linagora.petals.projects.filters.emptyJavaPackages"
            name="Empty Java Packages">
      </commonFilter>
      <commonFilter
            activeByDefault="true"
            class="com.linagora.petals.common.internal.projectscnf.JarFragmentFilter"
            id="com.linagora.petals.projects.filters.externalLibraries"
            name="External Libraries">
      </commonFilter>
      <navigatorContent
            activeByDefault="true"
            contentProvider="com.linagora.petals.common.internal.projectscnf.MinimalPetalsProjectContentProvider"
            id="com.linagora.petals.projects.root"
            labelProvider="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectLabelProvider"
            name="Root Categories"
            priority="highest">
         <triggerPoints>
         </triggerPoints>
         <commonSorter
               class="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectsSorter"
               id="com.linagora.petals.common.projectscnf.PetalsProjectResourceSorter">
         </commonSorter>
      </navigatorContent>
      <navigatorContent
            activeByDefault="true"
            contentProvider="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectContentProvider"
            id="com.linagora.petals.projects.sketches"
            labelProvider="com.linagora.petals.common.croquis.internal.projectscnf.PetalsCroquisLabelProvider"
            name="Croquis"
            priority="normal">
         <triggerPoints>
            <test
                  property="com.linagora.petals.common.project-category-id"
                  value="petals.category.croquis">
            </test>
         </triggerPoints>
         <commonSorter
               class="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectsSorter"
               id="com.linagora.petals.common.projectscnf.PetalsProjectResourceSorter">
         </commonSorter>
         <dropAssistant
               class="org.eclipse.ui.navigator.resources.ResourceDropAdapterAssistant"
               id="com.linagora.petals.services.dropAssistant">
            <possibleDropTargets>
               <or>
                  <adapt
                        type="org.eclipse.core.resources.IProject">
                  </adapt>
                  <adapt
                        type="org.eclipse.core.resources.IFolder">
                  </adapt>
                  <adapt
                        type="org.eclipse.core.resources.IFile">
                  </adapt>
               </or>
            </possibleDropTargets>
         </dropAssistant>
      </navigatorContent>
    </extension>
    <extension
          id="com.linagora.petals.common.markers"
          name="Petals markers"
          point="org.eclipse.core.resources.markers">
       <persistent
             value="true">
       </persistent>
       <super
             type="org.eclipse.core.resources.textmarker">
       </super>
       <super
             type="org.eclipse.core.resources.problemmarker">
       </super>
       <attribute
             name="com.linagora.petals.common.xpath.attribute">
       </attribute>
    </extension>
    <extension
          point="org.eclipse.core.contenttype.contentTypes">
       <content-type
             base-type="org.eclipse.core.runtime.xml"
             file-extensions="xml"
             file-names="jbi"
             id="com.linagora.petals.common.jbiContentType"
             name="JBI Content Type"
             priority="normal">
          <describer
                class="org.eclipse.core.runtime.content.XMLRootElementContentDescriber2">
             <parameter
                   name="element"
                   value="{http://java.sun.com/xml/ns/jbi}jbi">
             </parameter>
          </describer>
       </content-type>
    </extension>
    <extension
          point="org.eclipse.ui.editors.annotationTypes">
       <type
             markerType="com.linagora.petals.common.markers"
             name="com.linagora.petals.tools.eclipse.su.main.error"
             super="org.eclipse.ui.workbench.texteditor.error">
       </type>
    </extension>
    <extension
          point="org.eclipse.ui.menus">
       <menuContribution
             locationURI="popup:petals.projects.new?after=additions">
          <command
                commandId="org.eclipse.ui.newWizard"
                icon="icons/obj16/croquis.png"
                label="Croquis"
                style="push"
                tooltip="Create a new Petals croquis">
             <parameter
                   name="newWizardId"
                   value="com.linagora.petals.common.croquisWizard">
             </parameter>
          </command>
          <separator
                name="petals.new.separator1"
                visible="true">
          </separator>
          <command
                commandId="org.eclipse.ui.newWizard"
                icon="icons/obj16/new_wiz.gif"
                label="Other..."
                mnemonic="O"
                style="push">
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:petals.projects.resource.new?after=petals.wizard.new">
          <command
                commandId="org.eclipse.ui.newWizard"
                icon="icons/obj16/croquis.png"
                label="Croquis"
                style="push"
                tooltip="Create a new Petals croquis">
             <parameter
                   name="newWizardId"
                   value="com.linagora.petals.common.croquisWizard">
             </parameter>
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:petals.projects.import?after=petals.projects.import.separator">
          <command
                commandId="org.eclipse.ui.file.import"
                label="Import..."
                style="push">
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:petals.projects.export?after=petals.projects.export.separator">
          <command
                commandId="org.eclipse.ui.file.export"
                label="Export..."
                style="push">
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:org.eclipse.ui.popup.any?after=additions">
          <menu
                id="com.linagora.petals.common.actiongroup"
                label="Petals">
             <separator
                   name="com.linagora.petals.common.group.natures"
                   visible="false">
             </separator>
             <separator
                   name="com.linagora.petals.common.group.edit"
                   visible="true">
             </separator>
             <separator
                   name="com.linagora.petals.common.group.export"
                   visible="true">
             </separator>
          </menu>
       </menuContribution>
       <menuContribution
             locationURI="popup:com.linagora.petals.common.projects?before=group.edit">
          <menu
                commandId="org.eclipse.ui.navigate.showInQuickMenu"
                label="Show In">
             <command
                   commandId="org.eclipse.ui.navigate.showIn"
                   style="push">
                <parameter
                      name="org.eclipse.ui.navigate.showIn.targetId"
                      value="org.eclipse.jdt.ui.PackageExplorer">
                </parameter>
             </command>
             <command
                   commandId="org.eclipse.ui.navigate.showIn"
                   style="push">
                <parameter
                      name="org.eclipse.ui.navigate.showIn.targetId"
                      value="org.eclipse.ui.views.PropertySheet">
                </parameter>
             </command>
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="selection">
                   <iterate
                         ifEmpty="false"
                         operator="and">
                      <or>
                         <instanceof
                               value="org.eclipse.core.resources.IResource">
                         </instanceof>
                         <instanceof
                               value="org.eclipse.jdt.core.IJavaElement">
                         </instanceof></or>
                   </iterate>
                </with>
             </visibleWhen>
          </menu>
       </menuContribution>
       <menuContribution
             locationURI="popup:com.linagora.petals.common.projects?after=group.edit">
          <command
                commandId="org.eclipse.ui.edit.copy"
                label="Copy"
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="org.eclipse.ui.edit.paste"
                label="Paste"
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="org.eclipse.ui.edit.delete"
                label="Delete"
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="org.eclipse.ui.edit.move"
                label="Move..."
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="org.eclipse.ui.edit.rename"
                label="Rename..."
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="com.linagora.petals.common.refactorProject"
                label="Refactor..."
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="com.linagora.petals.common.configureBuildPathCommand"
                icon="icons/obj16/configure_build_path.gif"
                style="push">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <separator
                name="com.linagora.petals.common.editSeparator"
                visible="true">
          </separator>
       </menuContribution>
       <menuContribution
             locationURI="popup:com.linagora.petals.common.projects?after=additions">
          <command
                commandId="org.eclipse.ui.file.refresh"
                label="Refresh"
                style="push"
                tooltip="Refresh the workspace and the category contents">
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="selection">
                   <and>
                      <iterate
                            ifEmpty="false"
                            operator="and">
                         <instanceof
                               value="com.linagora.petals.common.internal.provisional.projectscnf.PetalsProjectCategory">
                         </instanceof>
                      </iterate>
                      <count
                            value="1">
                      </count>
                   </and>
                </with>
             </visibleWhen>
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:com.linagora.petals.common.actiongroup?before=com.linagora.petals.common.group.natures">
          <command
                commandId="com.linagora.petals.common.validate-jbi"
                label="Validate"
                style="push"
                tooltip="Validate jbi.xml files explicitly">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
          <command
                commandId="com.linagora.petals.common.addPetalsNature"
                label="Add Java Nature"
                style="push"
                tooltip="Add the Java nature to a project">
             <parameter
                   name="natureId"
                   value="org.eclipse.jdt.core.javanature">
             </parameter>
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="selection">
                   <iterate
                         ifEmpty="false"
                         operator="and">
                      <and>
                         <instanceof
                               value="org.eclipse.core.resources.IProject">
                         </instanceof>
                         <not>
                            <test
                                  property="org.eclipse.core.resources.projectNature"
                                  value="org.eclipse.jdt.core.javanature">
                            </test>
                         </not>
                      </and>
                   </iterate>
                   <count
                         value="1">
                   </count>
                </with>
             </visibleWhen>
          </command>
       </menuContribution>
       <menuContribution
             locationURI="popup:com.linagora.petals.common.actiongroup?after=com.linagora.petals.common.group.export">
          <command
                commandId="com.linagora.petals.common.fastexport"
                label="Fast Export for Petals"
                style="push"
                tooltip="Package a Petals project quickly">
             <visibleWhen
                   checkEnabled="true">
             </visibleWhen>
          </command>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="menu:com.linagora.petals.common.projects?after=additions">
          <menu
                label="Package Presentation">
             <command
                   commandId="com.linagora.petals.common.switchJavaPackagesLayout"
                   icon="icons/eview16/flatLayout.gif"
                   label="Flat"
                   style="radio">
                <parameter
                      name="org.eclipse.ui.commands.radioStateParameter"
                      value="flat">
                </parameter>
             </command>
             <command
                   commandId="com.linagora.petals.common.switchJavaPackagesLayout"
                   icon="icons/eview16/hierarchicalLayout.gif"
                   label="Hierarchical"
                   style="radio">
                <parameter
                      name="org.eclipse.ui.commands.radioStateParameter"
                      value="hierarchical">
                </parameter>
             </command>
          </menu>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
          <toolbar
                id="com.linagora.petals.common.petals-toolbar"
                label="Petals">
          </toolbar>
       </menuContribution>
    </extension>
    <extension
          point="org.eclipse.ui.perspectives">
       <perspective
             class="com.linagora.petals.common.internal.perpsective.PetalsPerspectiveFactory"
             icon="icons/obj16/pstudio_16x16.png"
             id="com.linagora.petals.common.mainPerspective"
             name="Petals">
          <description>
             A perspective to work with Petals tools.
          </description>
       </perspective>
    </extension>
    <extension
          point="org.eclipse.ui.perspectiveExtensions">
       <perspectiveExtension
             targetID="com.linagora.petals.common.mainPerspective">
          <showInPart
                id="org.eclipse.jdt.ui.PackageExplorer">
          </showInPart>
          <showInPart
                id="org.eclipse.ui.views.ResourceNavigator">
          </showInPart>
          <showInPart
                id="com.linagora.petals.common.projects">
          </showInPart>
       </perspectiveExtension>
       <perspectiveExtension
             targetID="org.eclipse.jdt.ui.JavaPerspective">
          <showInPart
                id="com.linagora.petals.common.projects">
          </showInPart>
          <perspectiveShortcut
                id="com.linagora.petals.common.mainPerspective">
          </perspectiveShortcut>
       </perspectiveExtension>
    </extension>
    <extension
          point="org.eclipse.ui.handlers">
       <handler
             class="com.linagora.petals.common.internal.commands.PetalsDeleteHandler"
             commandId="org.eclipse.ui.edit.delete">
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.PetalsMoveHandler"
             commandId="org.eclipse.ui.edit.move">
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.RefreshCategoryHandler"
             commandId="org.eclipse.ui.file.refresh">
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.PetalsRenameHandler"
             commandId="org.eclipse.ui.edit.rename">
          <activeWhen>
             <reference
                   definitionId="com.linagora.petals.common.inPetalsView">
             </reference></activeWhen>
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.PetalsCopyHandler"
             commandId="org.eclipse.ui.edit.copy">
          <activeWhen>
             <with
                   variable="activePartId">
                <equals
                      value="com.linagora.petals.common.projects">
                </equals>
             </with>
          </activeWhen>
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.PetalsPasteHandler"
             commandId="org.eclipse.ui.edit.paste">
          <activeWhen>
             <with
                   variable="activePartId">
                <equals
                      value="com.linagora.petals.common.projects">
                </equals>
             </with>
          </activeWhen>
       </handler>
       <handler
             class="com.linagora.petals.common.internal.commands.ConfigureBuildPathCommandHandler"
             commandId="com.linagora.petals.common.configureBuildPathCommand">
       </handler>
    </extension>
    <extension
          point="org.eclipse.core.runtime.preferences">
       <initializer
             class="com.linagora.petals.common.internal.preferences.PreferencesInitializer">
       </initializer>
    </extension>
    <extension
          point="org.eclipse.compare.contentMergeViewers">
       <viewer
             class="com.linagora.petals.common.internal.compare.XmlViewerCreator"
             extensions="xml, xsd, wsdl, bpel, composite"
             id="com.linagora.petals.common.xmlViewer">
       </viewer>
    </extension>
    <extension
          point="org.eclipse.ui.bindings">
       <key
             commandId="com.linagora.petals.common.fastexport"
             contextId="org.eclipse.ui.contexts.window"
             schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
             sequence="M1+F5">
       </key>
    </extension>
    <extension
          point="org.eclipse.core.expressions.propertyTesters">
       <propertyTester
             class="com.linagora.petals.common.internal.provisional.propertytester.JbiTypePropertyTester"
             id="com.linagora.petals.common.jbi-type-tester"
             namespace="com.linagora.petals.common"
             properties="jbi-type"
             type="org.eclipse.core.resources.IProject">
       </propertyTester>
       <propertyTester
             class="com.linagora.petals.common.internal.provisional.propertytester.ProjectCategoryPropertyTester"
             id="com.linagora.petals.common.project-category-tester"
             namespace="com.linagora.petals.common"
             properties="project-category-id"
             type="java.lang.Object">
       </propertyTester>
    </extension>
    <extension
          point="com.linagora.petals.common.projectCategories">
       <Category
             class="com.linagora.petals.common.croquis.internal.projectscnf.CroquisProjectCategory">
       </Category>
    </extension>
    <extension
          point="org.eclipse.core.expressions.definitions">
       <definition
             id="com.linagora.petals.common.inPetalsView">
          <with
                variable="activePartId">
             <equals
                   value="com.linagora.petals.common.projects">
             </equals>
          </with>
       </definition>
    </extension>
</plugin>
